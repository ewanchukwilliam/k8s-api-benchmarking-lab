# KEDA Helm Chart Values for EKS
# Install with: helm install keda kedacore/keda -n keda --create-namespace -f keda-values.yaml

# KEDA Operator settings
operator:
  name: keda-operator
  replicaCount: 2  # HA setup for production

  # Resource limits
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

  # Pod Disruption Budget
  podDisruptionBudget:
    minAvailable: 1

# Metrics Server (KEDA's metrics adapter)
metricsServer:
  replicaCount: 1

  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 250m
      memory: 256Mi

# Admission Webhooks
webhooks:
  enabled: true
  replicaCount: 1

  resources:
    requests:
      cpu: 50m
      memory: 64Mi
    limits:
      cpu: 100m
      memory: 128Mi

# Service Account
serviceAccount:
  create: true
  name: keda-operator
  annotations:
    # For AWS IAM Roles for Service Accounts (IRSA)
    # Uncomment and set your role ARN if using IRSA
    # eks.amazonaws.com/role-arn: arn:aws:iam::ACCOUNT_ID:role/keda-operator-role

# Pod Identity (for AWS Pod Identity)
podIdentity:
  activeDirectory:
    identity: ""
  aws:
    irsa:
      enabled: false
      # audience: sts.amazonaws.com
      # roleArn: ""
      # stsRegionalEndpoints: true
      # token:
      #   expiration: 86400

# Prometheus metrics for KEDA itself
prometheus:
  metricServer:
    enabled: true
    port: 8080
    portName: metrics
    path: /metrics

  operator:
    enabled: true
    port: 8080
    path: /metrics

  webhooks:
    enabled: true
    port: 8080
    path: /metrics

# Logging
logging:
  operator:
    level: info
    format: console
    timeEncoding: rfc3339

  metricServer:
    level: 0

  webhooks:
    level: info

# Pod scheduling
nodeSelector: {}
tolerations: []
affinity:
  podAntiAffinity:
    preferredDuringSchedulingIgnoredDuringExecution:
      - weight: 100
        podAffinityTerm:
          labelSelector:
            matchExpressions:
              - key: app.kubernetes.io/name
                operator: In
                values:
                  - keda-operator
          topologyKey: kubernetes.io/hostname

# Extra environment variables
extraEnvVars: []

# Custom certificates (if using private CA)
certificates:
  autoGenerated: true

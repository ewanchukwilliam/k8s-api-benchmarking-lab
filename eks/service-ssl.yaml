apiVersion: v1
kind: Service

metadata:
  name: health-service
  labels:
    app: health-service
  annotations:
    # Use NLB instead of Classic ELB for better performance
    service.beta.kubernetes.io/aws-load-balancer-type: "nlb"

    # SSL Certificate from ACM
    service.beta.kubernetes.io/aws-load-balancer-ssl-cert: "_516a5b5000c3c0ee6f852f0dab7463ad.jkddzztszm.acm-validations.aws."

    # Enable SSL on port 443
    service.beta.kubernetes.io/aws-load-balancer-ssl-ports: "443"

    # Modern SSL policy (TLS 1.2+)
    service.beta.kubernetes.io/aws-load-balancer-ssl-negotiation-policy: "ELBSecurityPolicy-TLS-1-2-2017-01"

spec:
  type: LoadBalancer

  selector:
    app: health-service

  ports:
  - name: http
    port: 80
    targetPort: 8080
  - name: https
    port: 443
    targetPort: 8080
